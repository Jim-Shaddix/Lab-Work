<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of Process_Data</title>
  <meta name="keywords" content="Process_Data">
  <meta name="description" content="this function sets all of the fields specified by plot_info">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html tdms_peak_analysis -->
<h1>Process_Data
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>this function sets all of the fields specified by plot_info</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function tdms_data = Process_Data(tdms_data, plot_info_struct) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> this function sets all of the fields specified by plot_info
 
 PARAMETERS
 * tdms_data: [struct array] all of the data that will be proccessed
 * plot_info_struct: [struct array] allows you to pass in a sepperate plot info struct, if you don't want
                     to use the one stored in tdms_data. The length of 
                     plot_info_struct must match the length of tdms_data.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../tdms_peak_analysis/Fits/Lorentz_Fit_File.html" class="code" title="function cell_peak_data = Lorentz_Fit_File(cell_x_cor_all, cell_real_cor_all, cell_imag_cor_all, cell_peak_data, cell_fit_options, given_bool)">Lorentz_Fit_File</a>	Lorentz_ Fit_File.m Fits a complex lorentzian function to all of the peaks</li><li><a href="../tdms_peak_analysis/Peaks/Get_Given_Peaks.html" class="code" title="function all_peak_info = Get_Given_Peaks(cell_frequency, cell_signal_x, cell_signal_y, cell_peaks_mag_given)">Get_Given_Peaks</a>	ALLOCATE: return value</li><li><a href="../tdms_peak_analysis/Peaks/Set_Peaks/Get_Set_Peaks.html" class="code" title="function all_peak_info = Get_Set_Peaks(cell_frequency, cell_signal_x, cell_signal_y, cell_peak_opts)">Get_Set_Peaks</a>	sets the peaks to be plotted: using [peakfind] for both</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="main.html" class="code" title="">main</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function peaks = Set_Fits(peaks, fit_options, given_bool)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function tdms_data = Process_Data(tdms_data, plot_info_struct)</a>
0002 <span class="comment">% this function sets all of the fields specified by plot_info</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% PARAMETERS</span>
0005 <span class="comment">% * tdms_data: [struct array] all of the data that will be proccessed</span>
0006 <span class="comment">% * plot_info_struct: [struct array] allows you to pass in a sepperate plot info struct, if you don't want</span>
0007 <span class="comment">%                     to use the one stored in tdms_data. The length of</span>
0008 <span class="comment">%                     plot_info_struct must match the length of tdms_data.</span>
0009     
0010     <span class="keyword">if</span> nargin &lt; 2
0011         plot_info_struct = [tdms_data.plot_info];
0012     <span class="keyword">end</span>
0013 
0014     <span class="comment">% SET: fit_data in peaks &amp; return peaks</span>
0015     <a name="_sub1" href="#_subfunctions" class="code">function peaks = Set_Fits(peaks, fit_options, given_bool) </a>
0016         peaks = <a href="../tdms_peak_analysis/Fits/Lorentz_Fit_File.html" class="code" title="function cell_peak_data = Lorentz_Fit_File(cell_x_cor_all, cell_real_cor_all, cell_imag_cor_all, cell_peak_data, cell_fit_options, given_bool)">Lorentz_Fit_File</a>(       <span class="keyword">...</span>
0017                         {frequency},    <span class="keyword">...</span>
0018                         {signal_x},     <span class="keyword">...</span>
0019                         {signal_y},     <span class="keyword">...</span>
0020                         peaks,          <span class="keyword">...</span>
0021                         fit_options,    <span class="keyword">...</span>
0022                         given_bool); 
0023     <span class="keyword">end</span>
0024 
0025     <span class="keyword">for</span> i = 1:length(tdms_data)
0026         <span class="comment">%% Shortcuts / Preprocess Data %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0027         
0028         <span class="comment">% easier access to data</span>
0029         td        = tdms_data(i);
0030         info      = plot_info_struct(i);
0031         frequency = td.frequency;
0032         signal_x  = td.signal_x;
0033         signal_y  = td.signal_y;
0034 
0035         <span class="comment">% preprocess the data</span>
0036         <span class="keyword">for</span> j = 1:length(info.preprocess)
0037             func = info.preprocess{j};
0038             signal_x = func(signal_x);
0039             signal_y = func(signal_y);
0040         <span class="keyword">end</span>
0041         
0042         <span class="comment">%% Get Peaks %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0043         param = {{frequency}, <span class="keyword">...</span>
0044                  {signal_x},  <span class="keyword">...</span>
0045                  {signal_y}};
0046 
0047         <span class="comment">% mag_given_peaks</span>
0048         <span class="keyword">if</span> sum(info.peaks_raw_given) &gt;= 1 || sum(info.peaks_mag_given) &gt;= 1
0049             given_peaks = <a href="../tdms_peak_analysis/Peaks/Get_Given_Peaks.html" class="code" title="function all_peak_info = Get_Given_Peaks(cell_frequency, cell_signal_x, cell_signal_y, cell_peaks_mag_given)">Get_Given_Peaks</a>(param{:}, {td.peaks_mag_given});
0050         <span class="keyword">end</span>
0051 
0052         <span class="comment">% mag_set_peaks</span>
0053         <span class="keyword">if</span> sum(info.peaks_raw_set) &gt;= 1 || sum(info.peaks_mag_set) &gt;= 1
0054             set_peaks = <a href="../tdms_peak_analysis/Peaks/Set_Peaks/Get_Set_Peaks.html" class="code" title="function all_peak_info = Get_Set_Peaks(cell_frequency, cell_signal_x, cell_signal_y, cell_peak_opts)">Get_Set_Peaks</a>(param{:}, {info.peak_options});
0055         <span class="keyword">end</span>
0056 
0057         <span class="comment">%% Get FIT DATA %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0058         
0059         <span class="comment">% mag_given_peaks</span>
0060         <span class="keyword">if</span> info.peaks_raw_given(2) || info.peaks_mag_given(2)
0061             given_peaks = <a href="#_sub1" class="code" title="subfunction peaks = Set_Fits(peaks, fit_options, given_bool)">Set_Fits</a>(given_peaks, {td.plot_info.fit_options}, 1); 
0062         <span class="keyword">end</span>
0063         
0064         <span class="comment">% mag_set_peaks</span>
0065         <span class="keyword">if</span> info.peaks_raw_set(2) || info.peaks_mag_set(2)
0066             set_peaks = <a href="#_sub1" class="code" title="subfunction peaks = Set_Fits(peaks, fit_options, given_bool)">Set_Fits</a>(set_peaks, {td.plot_info.fit_options}, 0);
0067         <span class="keyword">end</span>
0068         
0069         <span class="comment">%% SET DATA %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0070         <span class="keyword">if</span> sum(info.peaks_raw_given) &gt;= 1 || sum(info.peaks_mag_given) &gt;= 1
0071             [tdms_data(i).peaks_mag_given] = given_peaks{:};
0072         <span class="keyword">end</span>
0073         <span class="keyword">if</span> sum(info.peaks_raw_set) &gt;= 1 || sum(info.peaks_mag_set) &gt;= 1
0074             [tdms_data(i).peaks_mag_set]   = set_peaks{:};
0075         <span class="keyword">end</span>
0076 
0077         disp([<span class="string">'Finished Processing File '</span>,num2str(i),<span class="string">' of '</span>,num2str(length(tdms_data))])
0078     <span class="keyword">end</span> <span class="comment">% loop over tdms_data</span>
0079 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sun 19-Aug-2018 19:01:02 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>