<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of TDMS_readChannelOrGroup</title>
  <meta name="keywords" content="TDMS_readChannelOrGroup">
  <meta name="description" content="TDMS_readChannelOrGroup  Return data from a specific channel or group of channels">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html tdms_peak_analysis --><!-- ../menu.html Store_TDMS_Data --><!-- menu.html Matlab_readTDMS_package -->
<h1>TDMS_readChannelOrGroup
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>TDMS_readChannelOrGroup  Return data from a specific channel or group of channels</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [channelData,channelNames] = TDMS_readChannelOrGroup(TDMS_filename,group,channel,subset) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">TDMS_readChannelOrGroup  Return data from a specific channel or group of channels

   Original Author: Preston K. Manwaring
   Last modified  : 4/29/2011 JAH

   FORMAT 0:   First call to examine file contents
   =======================================================================
   [tempStruct] = TDMS_readChannelOrGroup(TDMS_filename,1)
   
   
   NOTE: For FORMAT 1 &amp; FORMAT 2, TDMS_filename can be replaced with
   the output from the FORMAT 0 call, tempStruct, to save on processing 
   time
   
   FORMAT 1:   To retrieve all channels in a group
   =======================================================================
   [channelData,channelNames] = 
               TDMS_readChannelOrGroup(TDMS_filename,groupName,[],*subset)
   
       ALTERNATIVELY ...

   [...] = TDMS_readChannelOrGroup(tempStruct,groupName,[],*subset)


   FORMAT 2:   To retrieve a specific channel from a group
   =======================================================================
   channelData = TDMS_readChannelOrGroup(TDMS_filename,groupName,channelName,*subset)


   Description: This file will read a channel out of a TDMS file and write
   the data to a local variable. It is a wrapper for TDMS_readTDMSfile.

   INPUTS:
   =======================================================================
   tempStruct    : output from previous call to this function, see
                   definition in OUTPUTS
   TDMS_filename : The name of the TDMS filename as a string 
                   (e.g.'C:\foo.tdms')
   groupName     : The group name in which the channel data reside 
                   (e.g. 'data Group')</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="TDMS_readTDMSFile.html" class="code" title="function [finalOutput,metaStruct] = TDMS_readTDMSFile(tdmsFileName,varargin)">TDMS_readTDMSFile</a>	TDMS_readTDMSFile  Reads TDMS file and does minimal processing to obtain output</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [channelData,channelNames] = TDMS_readChannelOrGroup(TDMS_filename,group,channel,subset)</a>
0002 <span class="comment">%TDMS_readChannelOrGroup  Return data from a specific channel or group of channels</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%   Original Author: Preston K. Manwaring</span>
0005 <span class="comment">%   Last modified  : 4/29/2011 JAH</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%   FORMAT 0:   First call to examine file contents</span>
0008 <span class="comment">%   =======================================================================</span>
0009 <span class="comment">%   [tempStruct] = TDMS_readChannelOrGroup(TDMS_filename,1)</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%   NOTE: For FORMAT 1 &amp; FORMAT 2, TDMS_filename can be replaced with</span>
0013 <span class="comment">%   the output from the FORMAT 0 call, tempStruct, to save on processing</span>
0014 <span class="comment">%   time</span>
0015 <span class="comment">%</span>
0016 <span class="comment">%   FORMAT 1:   To retrieve all channels in a group</span>
0017 <span class="comment">%   =======================================================================</span>
0018 <span class="comment">%   [channelData,channelNames] =</span>
0019 <span class="comment">%               TDMS_readChannelOrGroup(TDMS_filename,groupName,[],*subset)</span>
0020 <span class="comment">%</span>
0021 <span class="comment">%       ALTERNATIVELY ...</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%   [...] = TDMS_readChannelOrGroup(tempStruct,groupName,[],*subset)</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%   FORMAT 2:   To retrieve a specific channel from a group</span>
0027 <span class="comment">%   =======================================================================</span>
0028 <span class="comment">%   channelData = TDMS_readChannelOrGroup(TDMS_filename,groupName,channelName,*subset)</span>
0029 <span class="comment">%</span>
0030 <span class="comment">%</span>
0031 <span class="comment">%   Description: This file will read a channel out of a TDMS file and write</span>
0032 <span class="comment">%   the data to a local variable. It is a wrapper for TDMS_readTDMSfile.</span>
0033 <span class="comment">%</span>
0034 <span class="comment">%   INPUTS:</span>
0035 <span class="comment">%   =======================================================================</span>
0036 <span class="comment">%   tempStruct    : output from previous call to this function, see</span>
0037 <span class="comment">%                   definition in OUTPUTS</span>
0038 <span class="comment">%   TDMS_filename : The name of the TDMS filename as a string</span>
0039 <span class="comment">%                   (e.g.'C:\foo.tdms')</span>
0040 <span class="comment">%   groupName     : The group name in which the channel data reside</span>
0041 <span class="comment">%                   (e.g. 'data Group')</span>
0042 
0043 <span class="comment">%</span>
0044 <span class="comment">%   OPTIONAL INPUTS</span>
0045 <span class="comment">%   =======================================================================</span>
0046 <span class="comment">%   channelName   : (default []), if empty, retrieves all channels in a</span>
0047 <span class="comment">%                   group, otherwise specify the channel name to retrieve</span>
0048 <span class="comment">%                   (e.g. 'channel A')</span>
0049 <span class="comment">%   subset        : A subset of the raw data to retrieve, format is:</span>
0050 <span class="comment">%                   [starting sample  , # of samples to retrieve]</span>
0051 <span class="comment">%                   e.g. [100 50] would start retrieving data at the 100th</span>
0052 <span class="comment">%                   index and would retrieve 50 samples, 100 through 149</span>
0053 <span class="comment">%</span>
0054 <span class="comment">%   OUTPUTS:</span>
0055 <span class="comment">%   =======================================================================</span>
0056 <span class="comment">%   tempStruct    : (structure array with fields)</span>
0057 <span class="comment">%       .tdmsStruct    - main output of TDMS_readTDMSfile with no raw data</span>
0058 <span class="comment">%                        retrieved</span>
0059 <span class="comment">%       .metaStruct    - second output of TDMS_readTDMSfile</span>
0060 <span class="comment">%       .TDMS_filename - the filename that was passed in, this is used if</span>
0061 <span class="comment">%                        this structure gets passed in as an input</span>
0062 <span class="comment">%   channelData   : If requesting a single channel, channelData is the</span>
0063 <span class="comment">%                   data from that channel.  If requesting a group,</span>
0064 <span class="comment">%                   channelData is a cell array, where each index holds the</span>
0065 <span class="comment">%                   data for a specific channel</span>
0066 <span class="comment">%   channelNames  : (cell array of strings) Name of each channel, used to</span>
0067 <span class="comment">%                   match channelData to a channel name</span>
0068 <span class="comment">%</span>
0069 <span class="comment">%   EXAMPLES</span>
0070 <span class="comment">%   ================================================================</span>
0071 <span class="comment">%   1) Read 'myChannel' from 'myGroup', return all raw data</span>
0072 <span class="comment">%   channelData = TDMS_readChannelOrGroup('C:\myFile.tdms','myGroup','myChannel')</span>
0073 <span class="comment">%</span>
0074 <span class="comment">%   2) Retrieve all channels from myGroup, returning only the first 100 values</span>
0075 <span class="comment">%   channelData = TDMS_readChannelOrGroup('C:\myFile.tdms','myGroup',[],[1 100])</span>
0076 <span class="comment">%</span>
0077 <span class="comment">%   See also:</span>
0078 <span class="comment">%   TDMS_readTDMSFile</span>
0079 
0080 <span class="keyword">if</span> exist(<span class="string">'subset'</span>,<span class="string">'var'</span>)
0081     SUBSET_GET = subset;
0082 <span class="keyword">else</span>
0083     SUBSET_GET = [];
0084 <span class="keyword">end</span>
0085 
0086 <span class="keyword">if</span> ~exist(<span class="string">'channel'</span>,<span class="string">'var'</span>)
0087     channel = [];
0088 <span class="keyword">end</span>
0089 
0090 
0091 <span class="comment">%This is a bit messy but it works ...</span>
0092 <span class="keyword">if</span> isstruct(TDMS_filename)
0093     <span class="comment">%Unpack from previous call</span>
0094     tempStruct = TDMS_filename;
0095     
0096     tdmsStruct    = tempStruct.tdmsStruct;
0097     metaStruct    = tempStruct.metaStruct;
0098     TDMS_filename = tempStruct.TDMS_filename;
0099 <span class="keyword">else</span>
0100     <span class="comment">% get the TDMS file name properties before trying to load a big file</span>
0101     [tdmsStruct,metaStruct] = <a href="TDMS_readTDMSFile.html" class="code" title="function [finalOutput,metaStruct] = TDMS_readTDMSFile(tdmsFileName,varargin)">TDMS_readTDMSFile</a>(TDMS_filename,<span class="string">'GET_DATA_OPTION'</span>,<span class="string">'getNone'</span>);
0102     <span class="keyword">if</span> isnumeric(group)
0103         channelData = struct(<span class="string">'tdmsStruct'</span>,tdmsStruct,<span class="string">'metaStruct'</span>,metaStruct,<span class="string">'TDMS_filename'</span>,TDMS_filename);
0104         <span class="keyword">return</span>
0105     <span class="keyword">end</span>
0106 <span class="keyword">end</span>
0107 
0108 
0109 <span class="comment">% check to see if the group name given is valid. If not, give alternatives.</span>
0110 I = find(strcmpi(group,tdmsStruct.groupNames),1);
0111 <span class="keyword">if</span> isempty(I)
0112     fprintf(2,<span class="string">'Available group names are:\n'</span>);
0113     disp(char(tdmsStruct.groupNames));
0114     error(<span class="string">'Specified group name: %s, not found in TDMS file.'</span>,group);
0115 <span class="keyword">end</span>
0116 
0117 <span class="comment">% check to see if the channel name is valid. If not, give alternatives.</span>
0118 <span class="keyword">if</span> ~isempty(channel)
0119     J = find(strcmpi(channel,tdmsStruct.chanNames{I}),1);
0120     <span class="keyword">if</span> isempty(J)
0121         fprintf(2,<span class="string">'Available chan names are:\n'</span>);
0122         disp(char(tdmsStruct.chanNames{I}));
0123         disp(<span class="string">''</span>)
0124         error(<span class="string">'Specified channel name: %s, not found in TDMS file.'</span>,channel);
0125     <span class="keyword">end</span>
0126 <span class="keyword">end</span>
0127 
0128 <span class="comment">% Populate request structure</span>
0129 <span class="keyword">if</span> ~isempty(channel)
0130     indexOriginalPath      = tdmsStruct.chanIndices{I}(J);
0131     getStruct = struct(<span class="keyword">...</span>
0132         <span class="string">'fullPathsKeep'</span>,tdmsStruct.objectPathsOrig{indexOriginalPath});
0133 <span class="keyword">else</span>
0134     getStruct = struct(<span class="string">'groupsKeep'</span>,group);
0135 <span class="keyword">end</span>
0136 
0137 <span class="comment">%Retrieve data</span>
0138 tdmsStruct = <a href="TDMS_readTDMSFile.html" class="code" title="function [finalOutput,metaStruct] = TDMS_readTDMSFile(tdmsFileName,varargin)">TDMS_readTDMSFile</a>(TDMS_filename,<span class="keyword">...</span>
0139     <span class="string">'META_STRUCT'</span>,metaStruct, <span class="keyword">...</span>
0140     <span class="string">'GET_DATA_OPTION'</span>,<span class="string">'getSubset'</span>,<span class="keyword">...</span>
0141     <span class="string">'OBJECTS_GET'</span>,getStruct, <span class="keyword">...</span>
0142     <span class="string">'SUBSET_GET'</span>,SUBSET_GET);
0143 
0144 <span class="comment">%OUTPUT SETUP</span>
0145 <span class="comment">%==============================</span>
0146 <span class="keyword">if</span> ~isempty(channel)
0147     channelData = tdmsStruct.data{indexOriginalPath};
0148     channelNames = {channel};
0149 <span class="keyword">else</span>
0150     nChans = length(tdmsStruct.chanNames{I});
0151     channelData = cell(1,nChans);
0152     chanIndices = tdmsStruct.chanIndices{I};
0153     <span class="keyword">for</span> iChan = 1:nChans
0154         channelData(iChan) = tdmsStruct.data(chanIndices(iChan));
0155     <span class="keyword">end</span>
0156     channelNames = tdmsStruct.chanNames{I};
0157 <span class="keyword">end</span>
0158 
0159 <span class="keyword">end</span>
0160</pre></div>
<hr><address>Generated on Sun 19-Aug-2018 19:01:02 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>